<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NET-RUNNER | Terminal System</title>
    <script>
        window.CONFIG = {
            // Por defecto usa localhost, puede ser sobrescrito por GitHub Actions durante el despliegue
            WS_URL: 'WS_URL_PLACEHOLDER'
        };
    </script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="terminal">
        <canvas id="gameCanvas"></canvas>
        <div id="overlay">
            <div class="hud-top">
                <div class="hud-panel" style="padding: 10px 15px;">
                    <div class="panel-header">SYSTEM_UPLINK</div>
                    <div style="display: flex; flex-direction: column; gap: 4px;">
                        <div>IDENTITY: <span id="player-name" class="accent clickable" title="Click to change name">ANONYMOUS</span> <span id="player-color-indicator" class="clickable" title="Click to change color">â—ˆ</span></div>
                        <div>STATUS: <span id="connection-status" class="status-tag disconnected">DISCONNECTED</span></div>
                        <div>THEME: <span id="theme-selector" class="accent clickable" title="Click to cycle themes">NET_RUNNER</span></div>
                    </div>
                </div>
                <div class="hud-panel stats-panel">
                    <div class="panel-header" style="text-align: right;">AGENT_METRICS</div>
                    
                    <div class="vital-stats">
                        <div class="stat-group">
                            <span class="panel-label">HP</span>
                            <span id="player-hp" class="danger" style="letter-spacing: 2px;">|||||</span>
                        </div>
                        <div class="stat-group">
                            <span class="panel-label">SHD</span>
                            <span id="player-shield" style="color: #bc8cff; letter-spacing: 2px;">(((</span>
                        </div>
                    </div>

                    <div class="progression-stats">
                        <span class="panel-label">LVL</span>
                        <span id="player-level" class="accent">1</span>
                        <span id="player-xp" class="xp-bar">---</span>
                    </div>

                    <div class="resource-stats">
                        <div class="stat-item">
                            <span class="panel-label" style="color: #b87333;">CU</span>
                            <span id="player-copper">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="panel-label" style="color: #c0c0c0;">AG</span>
                            <span id="player-silver">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="panel-label" style="color: #ffd700;">AU</span>
                            <span id="player-gold">0</span>
                        </div>
                    </div>

                    <div class="combat-stats" style="display: flex; justify-content: flex-end; gap: 8px;">
                        <span class="panel-label">WPN</span>
                        <span id="player-weapon" class="accent">BASIC</span>
                    </div>

                    <div class="engine-stats">
                        <div class="stat-item">
                            <span class="panel-label">POS</span>
                            <span id="player-pos" class="accent">0.0, 0.0</span>
                        </div>
                        <div class="stat-item">
                            <span class="panel-label">SPD</span>
                            <span id="player-speed">0.00</span>
                        </div>
                        <div class="stat-item">
                            <span class="panel-label">ACC</span>
                            <span id="player-accel">0.00</span>
                        </div>
                    </div>

                    <div class="system-stats" style="margin-top: 4px; padding-top: 4px; border-top: 1px dotted rgba(48, 54, 61, 0.5);">
                        <div class="stat-item">
                            <span class="panel-label">LAT</span>
                            <span id="latency" class="accent">--ms</span>
                        </div>
                        <div class="stat-item">
                            <span id="fps" class="success">--</span>
                            <span class="panel-label" style="min-width: unset;">FPS</span>
                        </div>
                    </div>
                </div>
            </div>
            

            <div id="logs-container" style="position: absolute; bottom: 80px; left: 40px; pointer-events: auto;">
                <div id="debug-panel" class="hud-panel" style="width: 380px; margin-bottom: 10px; display: none; font-family: 'Cascadia Code', monospace; font-size: 11px;">
                    <div class="panel-header" style="color: var(--success);">[DEBUG_SYSTEM_ACTIVE]</div>
                    <div id="debug-content">
                        <!-- Debug info will be injected here -->
                    </div>
                </div>
                <div class="hud-panel" style="width: 380px;">
                    <div class="panel-header">CONSOLE_LOGS</div>
                    <div id="logs">
                        <div class="log-entry">> Initializing secure connection...</div>
                        <div class="log-entry">> Waiting for uplink...</div>
                    </div>
                    <div style="display: flex; align-items: center; width: 100%; border-top: 1px dotted var(--border); padding-top: 10px; margin-top: 5px;">
                        <span class="accent" style="margin-right: 10px;">></span>
                        <input type="text" id="chat-input" placeholder="Type command or message..." autocomplete="off" 
                               style="background: transparent; border: none; color: #c9d1d9; outline: none; flex-grow: 1; font-family: inherit; font-size: 12px;">
                    </div>
                </div>
            </div>

            <div id="minimap-container" style="position: absolute; bottom: 80px; right: 40px; pointer-events: auto;">
                <div id="minimap-panel" class="hud-panel" style="width: 250px; padding: 10px; display: flex; flex-direction: column;">
                    <div class="panel-header">RADAR_SYSTEM</div>
                    <canvas id="minimapCanvas" style="height: 180px;"></canvas>
                    <div id="player-list">
                        <!-- Players will be listed here -->
                    </div>
                </div>
            </div>

            <div id="tutorial-panel" class="hud-bottom">
                <div class="hud-panel">
                    <div class="panel-header" style="text-align: center;">OPERATIONAL_GUIDE</div>
                    <div id="guide-content" style="text-align: center;">
                        <span class="accent">WASD</span> to navigate | <span class="accent">SPACE/CLICK</span> to shoot | <span class="accent">C</span> to scan | <span class="accent">F11</span> full extraction
                    </div>
                </div>
            </div>

            <div id="mobile-controls">
                <div id="joystick-zone">
                    <div id="joystick-base">
                        <div id="joystick-stick"></div>
                    </div>
                </div>
                <div id="mobile-actions">
                    <button id="btn-scan" class="hud-panel mobile-btn">SCAN</button>
                    <button id="btn-shoot" class="hud-panel mobile-btn">FIRE</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@msgpack/msgpack@3.0.0-beta2/dist.es5+umd/msgpack.min.js"></script>
    <script src="js/game.js"></script>
</body>
</html>
